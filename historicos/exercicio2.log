
-- Adiciona campo para ser utilizado como fk em turma
mysql> ALTER TABLE turma ADD fk_tur_disciplina INT;


mysql> DESCRIBE turma;
+-------------------+----------+------+-----+---------+----------------+
| Field             | Type     | Null | Key | Default | Extra          |
+-------------------+----------+------+-----+---------+----------------+
| id                | int      | NO   | PRI | NULL    | auto_increment |
| codigo            | smallint | NO   |     | NULL    |                |
| periodo           | char(20) | NO   |     | NULL    |                |
| fk_tur_aluno      | int      | YES  | MUL | NULL    |                |
| fk_tur_disciplina | int      | YES  |     | NULL    |                |
+-------------------+----------+------+-----+---------+----------------+

-- Adiciona na tabela turma uma constraint que informa o campo escolhido como fk

mysql> ALTER TABLE turma ADD CONSTRAINT fk_tur_disciplina FOREIGN KEY (fk_tur_disciplina) REFERENCES disciplina(id);


mysql> DESCRIBE turma;
+-------------------+----------+------+-----+---------+----------------+
| Field             | Type     | Null | Key | Default | Extra          |
+-------------------+----------+------+-----+---------+----------------+
| id                | int      | NO   | PRI | NULL    | auto_increment |
| codigo            | smallint | NO   |     | NULL    |                |
| periodo           | char(20) | NO   |     | NULL    |                |
| fk_tur_aluno      | int      | YES  | MUL | NULL    |                |
| fk_tur_disciplina | int      | YES  | MUL | NULL    |                |
+-------------------+----------+------+-----+---------+----------------+


-- Tabela de aluno

mysql> DESCRIBE aluno;

+-----------------+--------------+------+-----+---------+----------------+
| Field           | Type         | Null | Key | Default | Extra          |
+-----------------+--------------+------+-----+---------+----------------+
| id              | int          | NO   | PRI | NULL    | auto_increment |
| nome            | varchar(100) | NO   |     | NULL    |                |
| data_nascimento | date         | NO   |     | NULL    |                |
| matricula       | int          | NO   |     | NULL    |                |
+-----------------+--------------+------+-----+---------+----------------+

-- Informa que na tabela aluno o campo matricula tem sua tipagem modificada
mysql> ALTER TABLE aluno MODIFY matricula INT NOT NULL UNIQUE;

-- Agora a tabela aluno tem matricula como unica para cada estudante

mysql> DESCRIBE aluno;
+-----------------+--------------+------+-----+---------+----------------+
| Field           | Type         | Null | Key | Default | Extra          |
+-----------------+--------------+------+-----+---------+----------------+
| id              | int          | NO   | PRI | NULL    | auto_increment |
| nome            | varchar(100) | NO   |     | NULL    |                |
| data_nascimento | date         | NO   |     | NULL    |                |
| matricula       | int          | NO   | UNI | NULL    |                |
+-----------------+--------------+------+-----+---------+----------------+

-- TB turma com um char tamanho 20

mysql> DESCRIBE turma;
+-------------------+----------+------+-----+---------+----------------+
| Field             | Type     | Null | Key | Default | Extra          |
+-------------------+----------+------+-----+---------+----------------+
| id                | int      | NO   | PRI | NULL    | auto_increment |
| codigo            | smallint | NO   |     | NULL    |                |
| periodo           | char(20) | NO   |     | NULL    |                |
| fk_tur_aluno      | int      | YES  | MUL | NULL    |                |
| fk_tur_disciplina | int      | YES  | MUL | NULL    |                |
+-------------------+----------+------+-----+---------+----------------+
5 rows in set (0.01 sec)

-- A tabela turma só permitirá que o campo periodo tenha ou 1 ou 2

mysql> ALTER TABLE turma ADD CONSTRAINT tur_periodo CHECK (periodo IN (1,2));


mysql> DESCRIBE turma;
+-------------------+----------+------+-----+---------+----------------+
| Field             | Type     | Null | Key | Default | Extra          |
+-------------------+----------+------+-----+---------+----------------+
| id                | int      | NO   | PRI | NULL    | auto_increment |
| codigo            | smallint | NO   |     | NULL    |                |
| periodo           | char(20) | NO   |     | NULL    |                |
| fk_tur_aluno      | int      | YES  | MUL | NULL    |                |
| fk_tur_disciplina | int      | YES  | MUL | NULL    |                |
+-------------------+----------+------+-----+---------+----------------+

mysql> ALTER TABLE turma MODIFY periodo CHAR(1);


mysql> DESCRIBE turma;
+-------------------+----------+------+-----+---------+----------------+
| Field             | Type     | Null | Key | Default | Extra          |
+-------------------+----------+------+-----+---------+----------------+
| id                | int      | NO   | PRI | NULL    | auto_increment |
| codigo            | smallint | NO   |     | NULL    |                |
| periodo           | char(1)  | YES  |     | NULL    |                |
| fk_tur_aluno      | int      | YES  | MUL | NULL    |                |
| fk_tur_disciplina | int      | YES  | MUL | NULL    |                |
+-------------------+----------+------+-----+---------+----------------+

